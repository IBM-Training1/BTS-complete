<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" type="text/css" href="getBug.css">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<title>Search Bug</title>
<script>
function getBugs() {
    const promise = fetch('/bug');
    promise.then(function (response) {
        return response.json();
    })
        .then(function (bugs) {
            console.log(bugs);
            const table = document.getElementById('bugsTable');
            table.innerHTML = "";
            for (let index = 0; index < bugs.length; index++) {
                console.log(bugs[index]);
                const currentBug = bugs[index];
                const row = document.createElement('tr');
                const nameColumn = document.createElement('td');
				//const descriptionColumn = document.createElement('td');
				const statusColumn = document.createElement('td');
				const priorityColumn = document.createElement('td');
				const typeColumn = document.createElement('td');
				const buildVersionColumn = document.createElement('td');
				const synopsisColumn = document.createElement('td');
				const severityColumn = document.createElement('td');
				const projectIdColumn = document.createElement('td');
				const moduleColumn = document.createElement('td');
				const productColumn = document.createElement('td');
				const etaColumn = document.createElement('td');

				nameColumn.append(currentBug.name);
				//descriptionColumn.append(bug.description);
				statusColumn.append(currentBug.status);
				priorityColumn.append(currentBug.priority);
				typeColumn.append(currentBug.type);
				buildVersionColumn.append(currentBug.buildVersion);
				synopsisColumn.append(currentBug.synopsis);
				severityColumn.append(currentBug.severity);
				projectIdColumn.append(currentBug.projectId);
				moduleColumn.append(currentBug.module);
				productColumn.append(currentBug.product);
				etaColumn.append(currentBug.eta);
				row.appendChild(nameColumn);
				//row.appendChild(descriptionColumn);
				row.appendChild(statusColumn);
				row.appendChild(priorityColumn);
				row.appendChild(typeColumn);
				row.appendChild(buildVersionColumn);
				row.appendChild(synopsisColumn);
				row.appendChild(severityColumn);
				row.appendChild(projectIdColumn);
				row.appendChild(moduleColumn);
				row.appendChild(productColumn);
				row.appendChild(etaColumn);

				table.appendChild(row);
            }
        })
}
         		
function getBug() {
	const getBug = document.getElementById('getBug');
	if (!getBug.checkValidity()) {
		alert('form is invalid');
		return;
	}
	let name = document.getElementById('bugName').value;
	name = name.trim();
	if (bugName) {
		const promise = fetch('/bug/' + name);
		promise.then(function(response) {
			return response.json();
		}).then(function(bug) {
			if (bug) {
				const table = document.getElementById('bugsTable');
				const rows=table.children.length;
				for(let count=0;count<rows;count++){
					table.children[0].remove();
				}
				const row = document.createElement('tr');
				const nameColumn = document.createElement('td');
				//const descriptionColumn = document.createElement('td');
				const statusColumn = document.createElement('td');
				const priorityColumn = document.createElement('td');
				const typeColumn = document.createElement('td');
				const buildVersionColumn = document.createElement('td');
				const synopsisColumn = document.createElement('td');
				const severityColumn = document.createElement('td');
				const projectIdColumn = document.createElement('td');
				const moduleColumn = document.createElement('td');
				const productColumn = document.createElement('td');
				const etaColumn = document.createElement('td');

				nameColumn.append(bug.name);
				//descriptionColumn.append(bug.description);
				statusColumn.append(bug.status);
				priorityColumn.append(bug.priority);
				typeColumn.append(bug.type);
				buildVersionColumn.append(bug.buildVersion);
				synopsisColumn.append(bug.synopsis);
				severityColumn.append(bug.severity);
				projectIdColumn.append(bug.projectId);
				moduleColumn.append(bug.module);
				productColumn.append(bug.product);
				etaColumn.append(bug.eta);
				row.appendChild(nameColumn);
				//row.appendChild(descriptionColumn);
				row.appendChild(statusColumn);
				row.appendChild(priorityColumn);
				row.appendChild(typeColumn);
				row.appendChild(buildVersionColumn);
				row.appendChild(synopsisColumn);
				row.appendChild(severityColumn);
				row.appendChild(projectIdColumn);
				row.appendChild(moduleColumn);
				row.appendChild(productColumn);
				row.appendChild(etaColumn);

				table.appendChild(row);
			} else {
				alert("invalid bug Name");
			}
		});

	} else {
		alert("invalid Bug name");
	}
}</script>
</head>

<body>
	<header class="header">
		<nav class="navbar navbar-style">
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse"
						data-target="#menu">
						<span class="icon-bar"></span> <span class="icon-bar"></span> <span
							class="icon-bar"></span>
					</button>
					<a href=""><img class="logo" src="logo.png"></a>
				</div>
				<div class="collapse navbar-collapse" id="menu">
					<ul class="nav navbar-nav navbar-right">
						<li><a href="index.html">Home</a></li>
						<li><a href="aboutUs.html">About Us</a></li>
						<li><a href="contactUs.html">Help</a></li>
					</ul>
				</div>
			</div>

		</nav>
	</header>
	<div class="background">
		<br>

		<div class="center" id="box">
			<form id="getBug">
				<table class="table">
					<tr>
						<td>Bug Name:</td>
						<td><input id="bugName" placeholder="" required></td>
					</tr>
				</table>
				<h6>Required field</h6>
				<a class="btn btn-first" onclick="getBug()" href="#">Search</a>
				<a class="btn btn-first" onclick="getBugs()" href="#">Get All Bugs</a>
		</div>
		<br> <br>
		<div class="table-responsive">

			<table class=" table table-bordered "
				style="border: 2px solid #000000; margin-top: 50px">
				<thead style="background-color:grey; color:white">
					<td scope="col" style="border: 2px solid #000000;">Name</td>
					<td scope="col" style="border: 2px solid #000000;">Status</td>
					<td scope="col" style="border: 2px solid #000000;">Priority</td>
					<td scope="col" style="border: 2px solid #000000;">Type</td>
					<td scope="col" style="border: 2px solid #000000;">BuildVersion</td>
					<td scope="col" style="border: 2px solid #000000;">Synopsis</td>
					<td scope="col" style="border: 2px solid #000000;">Severity</td>
					<td scope="col" style="border: 2px solid #000000;">ProjectId</td>
					<td scope="col" style="border: 2px solid #000000;">Module</td>
					<td scope="col" style="border: 2px solid #000000;">Product</td>
					<td scope="col" style="border: 2px solid #000000;">Estimated Date</td>
				</thead>
				<tbody id='bugsTable' style="border: 2px solid #000000;"></tbody>
			</table>
		</div>
		<br> <br>
		</form>
		<br>
		<footer class="page-footer font-small blue" id="footer">

			<div class="footer-copyright text-center py-3">
				<small>Â© 2021 Copyright ServerMonks</small>

			</div>

		</footer>
	</div>
</body>

</html>